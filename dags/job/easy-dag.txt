from datetime import datetime, timedelta
from airflow import DAG
from airflow.decorators import task
from model.config import Config
from time import tzset
from sqlalchemy import create_engine
from requests import get

tzset()


with DAG(dag_id="add_user_to_database",
         description="Add user to database",
         start_date=datetime.now() - timedelta(days=1),
         schedule="@once",
         tags=["pokemon"]) as dag:
    
    @task()
    def add_user_to_database():
        users = get("http://discord-bot:5000/caller?function=get-user").json().datas
        print(users)
        
        
    
    add_user_to_database()
    
